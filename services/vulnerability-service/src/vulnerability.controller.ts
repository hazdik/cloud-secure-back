import { Controller, Post, Body } from '@nestjs/common';

interface InspectorScanRequest {
  awsAccountId: string;
  region: string;
}

interface VulnerabilityResult {
  id: string;
  severity: string;
  description: string;
  detectedAt: string;
}

@Controller('vulnerability')
export class VulnerabilityController {
  @Post('scan')
  async scan(@Body() req: InspectorScanRequest): Promise<VulnerabilityResult[]> {
    // TODO: Integrate AWS Inspector API, store results in MongoDB
    return [
      {
        id: 'vuln-001',
        severity: 'CRITICAL',
        description: 'Unpatched CVE-2025-1234',
        detectedAt: new Date().toISOString()
      }
    ];
  }
}

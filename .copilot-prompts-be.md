[Backend] B-BE-001 - Auth Service  
"Create authService in Node.js (NestJS). 
Implement /auth/register, /auth/login, /auth/invite, /auth/refresh endpoints.
Use bcrypt for password hash, JWT for tokens, Redis for session store."

[Backend] B-BE-002 - RBAC Middleware  
"Develop an RBAC middleware for NestJS. 
Attach role metadata to routes and verify permissions from user’s JWT claims."

[Backend] B-BE-003 - Invite Flow  
"Implement invite endpoint. 
Send email with one-time activation token (JWT). 
On activation, create new user record and issue access token."

[Backend] B-BE-004 - Metrics API  
"Create /metrics/overview API. 
Aggregate data from threatService, complianceService, costService.
Return JSON with compliance %, security score, open threats, monthly savings."

[Backend] B-BE-005 - AI Threat Analyzer  
"Develop a Python microservice to detect anomalies. 
Consume cloud logs from RabbitMQ, score using ML model, 
store anomalies in MongoDB, and publish summaries back to metricsService."

[Backend] B-BE-006 - Compliance Data Fetcher  
"Build complianceService to fetch cloud config data via AWS Config, Azure Policy, GCP SCC APIs. 
Store rule violations and compliance mappings."

[Backend] B-BE-007 - Threat Service  
"Implement threatService to process incoming security events from cloud connectors. 
Run anomaly detection, classify severity, create records in DB."

[Backend] B-BE-008 - Vulnerability Integration  
"Integrate AWS Inspector API to fetch vulnerability scans and store results in MongoDB."

[Backend] B-BE-009 - Auto-Assign Threats  
"Build workflow logic that auto-assigns high-severity threats 
to corresponding team leads based on configuration."

[Backend] B-BE-010 - ML Cost Prediction  
"Implement ML regression model to predict optimal resource usage and cost savings.
Expose endpoint /cost/optimize for predictions."

[Backend] B-BE-011 - Scheduled Cost Jobs  
"Schedule a daily cron job to collect cost metrics from cloud billing APIs.
Update PostgreSQL with daily usage snapshots."

[Backend] B-BE-012 - Cost Reports  
"Generate weekly cost reports in CSV & PDF. 
Email to admin using SES or SendGrid. Store reports in S3."

[Backend] B-BE-013 - Audit Service  
"Build auditService to store immutable logs in MongoDB.
Capture all CRUD and system events using middleware hook."

[Backend] B-BE-014 - Report Export API  
"Develop /reports/export API.
Accept query params type (pdf/csv/json). Generate report dynamically and return URL."

[Backend] B-BE-015 - Scheduled Exports  
"Use Node cron to schedule compliance reports every Monday 6 AM."


[Backend] B-BE-016 - Auto-Assignment Logic  
"Implement AI-based auto-assign engine. 
Inputs: incident type, team matrix, historical patterns. 
Output: assigned user ID. Update ticket record."

[Backend] B-BE-017 - Integration Adapters  
"Integrate Jira and ServiceNow API adapters. 
Sync tickets and status bi-directionally."

[Backend] B-BE-018 - SLA Alerts  
"Build SLA timer engine using Redis TTL. 
Trigger alert via notificationService 15 mins before deadline."

[Backend] B-BE-019 - Estate API  
"Create /estate/map endpoint returning JSON structure of cloud estate hierarchy."

[Backend] B-BE-020 - Sync Jobs  
"Implement background sync job that runs every 6 hours 
to fetch resource lists from AWS, Azure, GCP APIs."

[Backend] B-BE-021 - Notification Microservice  
"Implement notificationService with unified publish interface.
Supports Slack, Email, Webhook destinations."

[Backend] B-BE-022 - Adapters  
"Create integration adapters for Slack (webhook), Teams (adaptive card), PagerDuty (incident API)."

[Backend] B-BE-023 - Delivery Log  
"Store every alert delivery event in MongoDB with timestamp, status, and channel."

[Backend/Infra] Docker Setup  
"Create Dockerfiles for frontend and backend. 
Use multi-stage build for production. 
Set up docker-compose for local environment."

[Backend/Infra] Kubernetes Setup  
"Write Helm charts for deployment: 
Include services, deployments, configmaps, secrets, ingress for frontend + backend."

[Backend/Infra] CI/CD Pipeline  
"Setup GitHub Actions workflows:
- build/test/lint
- push Docker images to registry
- deploy to EKS via kubectl + Helm"

[Backend/Infra] Observability Stack  
"Integrate Prometheus for metrics, Loki for logs, Grafana for dashboards.
Expose metrics endpoints in each microservice."

[Backend/Infra] Security  
"Enable JWT signing via HMAC, encrypt secrets via AWS KMS,
and configure WAF/Ingress rules for API gateway."


[Rule-AWS-001] Ensure S3 Buckets are not Public
- Condition: "aws:s3:bucket.acl != 'public-read' && != 'public-read-write'"
- Frameworks: CIS 1.2.0, SOC2, ISO27001 A.9.1.2  
- Severity: HIGH  
- Remediation: "Set ACL to private and enable Block Public Access"

[Rule-AWS-002] Enforce Multi-Factor Authentication for Root Account
- Condition: "aws:iam:root.mfa_enabled == false"
- Frameworks: CIS 1.3.0, NIST IA-2  
- Severity: CRITICAL  
- Remediation: "Enable MFA for root via AWS IAM console"

[Rule-AWS-003] Disallow Security Groups with Open Inbound Ports (0.0.0.0/0)
- Condition: "aws:ec2:security_group.ingress.cidr == '0.0.0.0/0'"
- Frameworks: CIS 4.1, SOC2, PCI-DSS 1.2.1  
- Severity: CRITICAL  
- Remediation: "Restrict inbound rules to specific IP ranges"

[Rule-AWS-004] Enforce EBS Encryption at Rest
- Condition: "aws:ebs:volume.encrypted == false"
- Frameworks: ISO27001 A.10.1, CIS 2.1.0  
- Severity: HIGH  
- Remediation: "Enable encryption using KMS-managed keys"

[Rule-AWS-005] Ensure CloudTrail is Enabled in All Regions
- Condition: "aws:cloudtrail:status != 'enabled'"
- Frameworks: CIS 2.1.3, SOC2 CC6.6  
- Severity: HIGH  
- Remediation: "Enable CloudTrail across all AWS regions"

[Rule-AWS-006] Ensure RDS Backups Are Enabled
- Condition: "aws:rds:backup.retention_period == 0"
- Frameworks: CIS 4.2.0, ISO27001 A.12.3  
- Severity: MEDIUM  
- Remediation: "Set automated backup retention > 7 days"

[Rule-AWS-007] Enforce IAM Password Policy
- Condition: "aws:iam:password_policy.min_length < 12"
- Frameworks: NIST IA-5, ISO27001 A.9.4.3  
- Severity: MEDIUM  
- Remediation: "Update IAM password policy to min length 12, expiry 90 days"

[Rule-AWS-008] Detect Unused IAM Users
- Condition: "aws:iam:user.last_activity_days > 90"
- Frameworks: CIS 1.5.0, SOC2 CC6.1  
- Severity: LOW  
- Remediation: "Disable or remove unused IAM users"

[Rule-AWS-009] Ensure GuardDuty is Enabled
- Condition: "aws:guardduty:detector.status != 'enabled'"
- Frameworks: CIS 3.4, ISO27001 A.12.6.1  
- Severity: HIGH  
- Remediation: "Enable GuardDuty for all regions"

[Rule-AZ-001] Ensure Network Security Groups Do Not Allow Inbound from Internet
- Condition: "azure:nsg:rule.source == 'Internet' && direction == 'Inbound'"
- Frameworks: CIS 2.2.0, SOC2, ISO27001 A.13.1  
- Severity: CRITICAL  
- Remediation: "Restrict inbound rules to trusted subnets"

[Rule-GCP-001] Ensure Default VPC Networks Are Deleted
- Condition: "gcp:vpc:network.name == 'default'"
- Frameworks: CIS 1.1, ISO27001 A.13.1.3  
- Severity: MEDIUM  
- Remediation: "Delete default network, use custom networks"

[Rule-GLOBAL-001] Ensure All Resources Have Tags
- Condition: "resource.tags.count < 1"
- Frameworks: ISO27001 A.8.1.1  
- Severity: LOW  
- Remediation: "Add mandatory tags (Owner, Environment, CostCenter)"

# AI PROMPT FOR COMPLIANCE RULE ENGINE
"Develop a complianceRuleEngine microservice.
- Load rule definitions (YAML/JSON) from PostgreSQL.
- Evaluate incoming resource configs from AWS, Azure, GCP.
- Map each finding to framework controls.
- Send non-compliant findings to MongoDB and trigger notificationService.
- Enable auto-remediation hooks where applicable.
- Provide APIs:
   • GET /rules/list
   • POST /rules/evaluate
   • POST /rules/remediate
   • GET /rules/report"
